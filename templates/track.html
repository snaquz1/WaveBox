{% extends 'base.html' %}
{% load static %}
{% block title %}{{ t.name }} - {{ t.author }}{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{% static "MainApp/css/track.css" %}">
{% endblock %}
—Ñ
{% block body %}
    <div class="track-page-container">
        <div class="track-player">
            <div class="track-item">
                <div class="track-image">
                        <img src="{{ t.image.url }}">
                    <div class="play-overlay">
                        <button data-track-id="{{ t.id }}" data-track-name="{{ t.name }}" data-track-author="{{ t.author }}"
                                data-liked="{% if user in t.liked_by.all %}true{% else %}false{% endif %}"
                                data-likes-count="{{ t.like_count }}"
                                data-track-image-src="{{ t.image.url }}"
                                class="play-button" onclick="playTrack(this)">‚ñ∂</button>
                        <audio class="audio" src="{{ t.audiofile.url }}"></audio>
                    </div>
                </div>

                <div class="track-info">
                    <h3 class="track-name">{{ t.name }}</h3>
                    <a href="/profile/{{ t.author }}"><h3 class="track-author">{{ t.author }}</h3></a>
                </div>
            </div>
            <div class="track-actions">
                <a href="/download/{{ t.id }}"><button class="action-btn download-btn">üì• Download</button></a>
            </div>
        </div>
    </div>

     <!-- –°–µ–∫—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
        <div class="comment-section">
            <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ comments|length }})</h3>
            {% for c in comments %}
                <div class="comment">
                <div class="avatar-username">
                    <div class="comment-avatar"><a href="/profile/{{ c.user.username }}"><img class="user-avatar" width="150px" height="150" src="{% if c.user.avatar %}{{ c.user.avatar.url }}{% else %}/media/images/user_avatars/noavatar.png{% endif %}"></a></div>
                    <div><a class="username" href="/profile/{{ c.user.username }}">{{ c.user.username }}
                    </a>
                    <div class="comment-meta">
                        <span class="comment-date">{{ c.date|date:"d.m.Y H:i" }}</span>
                    </div>
                    </div>
                </div>
                    <div class="comment-text">{{ c.text }}</div>
                </div>
            {% empty %}
                <p class="no-comments">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
            {% endfor %}
        
            {% if user.is_authenticated %}
    <div class="add-comment-section">
        <form method="post" class="comment-form">
            {% csrf_token %}
            <textarea name="text" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required></textarea>
            <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
    </div>
    {% endif %}
        </div>
    


<input class="comment-wrote" type="hidden" value="{{ comment_wrote }}">
{% block script %}
    <script src="{% static "MainApp/js/commentscroll.js" %}"></script>
{% endblock %}
{% endblock %}